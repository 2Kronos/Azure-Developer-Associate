# Circuit

[Final integration](https://www.tinkercad.com/things/gEQuQXV6KUj-phase-2-simulation-24-)
# Code 

```c++
#include <IRremote.hpp>

const int IR_PIN = 3;
const int POT_PIN = A0;
unsigned long inputVal;
int currentPowerLevel = 0;
bool useIRPower = 0;

void setup() {
    IrReceiver.begin(IR_PIN, ENABLE_LED_FEEDBACK);
    pinMode(POT_PIN, INPUT);
    Serial.begin(9600);
    Serial.println("Solar Powered Washing Machine - Simulation 1");
    Serial.println("Power Management System Ready");
    Serial.println("-------------------------------");
}

void loop() {
    // Test the checkPower function with different requirements
    checkPower(3, 13);  // Check if maximum power (3) is available
    delay(2000);
    
    checkPower(2, 12);  // Check if moderate power (2) is available  
    delay(2000);
    
    checkPower(1, 11);  // Check if minimum power (1) is available
    delay(2000);
}

// REQUIRED FUNCTION: checkPower(int requiredPowerLevel, int pinNum)
void checkPower(int requiredPowerLevel, int pinNum) {
    // Get current available power
    int availablePower = getCurrentPowerLevel();
    
    Serial.print("Checking power for requirement: ");
    Serial.print(requiredPowerLevel);
    Serial.print(" | Available: ");
    Serial.print(availablePower);
    
    // Check if sufficient power is available
    if (availablePower >= requiredPowerLevel) {
        Serial.println(" - SUFFICIENT POWER");
        // Additional functionality can be added here based on pinNum
    } else {
        Serial.println(" - INSUFFICIENT POWER");
        Serial.println("Washing machine pausing until power available...");
    }
    Serial.println("-------------------------------");
}

// Get the current power level from either IR or potentiometer
int getCurrentPowerLevel() {
    checkIR();          // Check for IR remote input first
    checkPotentiometer(); // Check potentiometer if no IR signal
    resetFlags();       // Reset for next iteration
    
    return currentPowerLevel;
}

// Function to check IR remote
void checkIR() {
    if (IrReceiver.decode()) {
        inputVal = IrReceiver.decodedIRData.decodedRawData;
        IrReceiver.resume();
        
        int irLevel = irPower(inputVal);
        if (irLevel != -1) {
            currentPowerLevel = irLevel;
            useIRPower = 1;
            Serial.print("IR Signal Received: ");
            displayPowerLevel(currentPowerLevel);
        }
    }
}

// Function to check potentiometer
void checkPotentiometer() {
    if (useIRPower == 0) {
        int potIn = analogRead(POT_PIN);
        currentPowerLevel = map(potIn, 0, 1023, 3, 0);
        currentPowerLevel = constrain(currentPowerLevel, 0, 3);
        
        Serial.print("Potentiometer Reading: ");
        displayPowerLevel(currentPowerLevel);
    }
}

// Function to reset flags
void resetFlags() {
    useIRPower = 0;
}

// Function to convert IR code to power level
int irPower(unsigned long irValue) {
    switch(irValue) {
        case 4077698816: return 0; // Category 0
        case 4010852096: return 1; // Category 1
        case 3994140416: return 2; // Category 2
        case 3977428736: return 3; // Category 3
        default: return -1; // Invalid code
    }
}

// Function to display power level description
void displayPowerLevel(int powerLevel) {
    switch(powerLevel) {
        case 0: Serial.println("Power Level 0: Battery charging"); break;
        case 1: Serial.println("Power Level 1: Insufficient Power"); break;
        case 2: Serial.println("Power Level 2: Moderate Power"); break;
        case 3: Serial.println("Power Level 3: Maximum Power"); break;
        default: Serial.println("Invalid power reading"); break;
    }
}
```

# OUTPUT

```C++

Potentiometer Reading: Power Level 0: Battery charging 
Checking power for requirement: 2 | Available: 0 - INSUFFICIENT POWER Washing
 machine pausing until power available...
 
 ------------------------------- 
 IR Signal Received: Power Level 2: Moderate Power
  Checking power for requirement: 1 | Available: 2 - SUFFICIENT POWER
  
 ------------------------------- 
 Potentiometer Reading: Power Level 0: Battery charging
  Checking power for requirement: 3 | Available: 0 - INSUFFICIENT POWER Washing machine pausing until power available...
  
 ------------------------------- 
 IR Signal Received: Power Level 3: Maximum Power
  Checking power for requirement: 2 | Available: 3 - SUFFICIENT POWER
  
 -------------------------------
  Potentiometer Reading: Power Level 0: Battery charging 
  Checking power for requirement: 1 | Available: 0 - INSUFFICIENT POWER Washing machine pausing until power available...
  
 -------------------------------
```
# Notes 



## **How the Power Simulation Works:**

### **1. Potentiometer (Pin A0) - Municipal Power / Baseline**
- Represents the **minimum guaranteed power** from the grid/municipal source
- This is the **base power** that's always available
- You set this to simulate normal household power conditions
- **Example:** If set to Level 0, it means municipal power is only enough for basic needs (battery charging)

### **2. IR Remote (Pin 3) - Solar Panel Power**
- Represents **additional solar power** from the sun
- This is **extra, free energy** that becomes available when the sun shines
- You press buttons to simulate clouds clearing, sun coming out, etc.
- **Temporary boosts** that override the base power

### **3. How They Work Together:**

**Normal Operation:**
```cpp
// Normally uses pot value (municipal power)
Potentiometer Reading: Power Level 0: Battery charging
```

**When Sun Shines (You Press IR Button):**
```cpp
// Solar power adds to municipal power
IR Signal Received: Power Level 2: Moderate Power
```

**When Sun Goes Away (You Stop Pressing):**
```cpp
// Returns to municipal power only
Potentiometer Reading: Power Level 0: Battery charging
```

## **Real-World Scenario Example:**

1. **Cloudy Day:** Pot set to Level 1 → Limited power available
2. **Sun Comes Out:** Press IR button for Level 3 → Extra solar power!
3. **Washing Machine:** Sees Level 3 available → Starts energy-intensive cycle
4. **Clouds Return:** Stop pressing button → Returns to Level 1
5. **Washing Machine:** Sees only Level 1 → Pauses until more power available

## **This Matches Your Project Description:**
> "The solar system indicate to the washing machine how much unused electrical energy is available."

- **Potentiometer:** Base municipal power (always available)
- **IR Remote:** Additional solar power (when available)
- **Combined:** Total power available for the washing machine

So I am simulating **both power sources working together**! The washing machine can only use whatever total power is available at any moment.

---

## **What `pinNum` Will Be Used For Later:**

In the next simulations, different components will require different power levels:

```cpp
// In future simulations, each component will have its own power requirement
checkPower(1, PUMP_PIN);        // Water pump might need power level 1
checkPower(2, DRUM_MOTOR_PIN);  // Drum motor might need power level 2  
checkPower(3, HEATER_PIN);      // Heater might need power level 3 (not used in your case)
```
